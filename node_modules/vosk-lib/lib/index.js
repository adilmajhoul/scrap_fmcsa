"use strict";var P=Object.create;var c=Object.defineProperty;var y=Object.getOwnPropertyDescriptor;var T=Object.getOwnPropertyNames;var S=Object.getPrototypeOf,M=Object.prototype.hasOwnProperty;var p=(r,e)=>{for(var t in e)c(r,t,{get:e[t],enumerable:!0})},z=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of T(e))!M.call(r,n)&&n!==t&&c(r,n,{get:()=>e[n],enumerable:!(i=y(e,n))||i.enumerable});return r};var g=(r,e,t)=>(t=r!=null?P(S(r)):{},z(e||!r||!r.__esModule?c(t,"default",{value:r,enumerable:!0}):t,r)),W=r=>z(c({},"__esModule",{value:!0}),r);var J={};p(J,{Model:()=>m,Recognizer:()=>k,SpeakerModel:()=>v,default:()=>G,libvosk:()=>o,setLogLevel:()=>x});module.exports=W(J);var f={};p(f,{Model:()=>m,SpeakerModel:()=>v,libvosk:()=>o});var a=g(require("path")),R=g(require("ffi-napi")),l=g(require("ref-napi")),U=l.default.types.void,_=l.default.refType(U),O=l.default.types.void,d=l.default.refType(O),B=l.default.types.void,s=l.default.refType(B);function j(){let r=a.default.resolve(__dirname,"..",`bin-${process.platform}-${process.arch}`);return process.platform=="win32"?(process.env.Path=r+a.default.delimiter+process.env.Path,a.default.join(r,"libvosk.dll")):process.platform=="darwin"?a.default.join(r,"libvosk.dylib"):a.default.join(r,"libvosk.so")}var o=R.default.Library(j(),{vosk_set_log_level:["void",["int"]],vosk_model_new:[_,["string"]],vosk_model_free:["void",[_]],vosk_spk_model_new:[d,["string"]],vosk_spk_model_free:["void",[d]],vosk_recognizer_new:[s,[_,"float"]],vosk_recognizer_new_spk:[s,[_,"float",d]],vosk_recognizer_new_grm:[s,[_,"float","string"]],vosk_recognizer_free:["void",[s]],vosk_recognizer_set_max_alternatives:["void",[s,"int"]],vosk_recognizer_set_words:["void",[s,"bool"]],vosk_recognizer_set_partial_words:["void",[s,"bool"]],vosk_recognizer_set_spk_model:["void",[s,d]],vosk_recognizer_accept_waveform:["bool",[s,"pointer","int"]],vosk_recognizer_result:["string",[s]],vosk_recognizer_final_result:["string",[s]],vosk_recognizer_partial_result:["string",[s]],vosk_recognizer_reset:["void",[s]]}),m=class{constructor(e){this.handle=o.vosk_model_new(e)}free(){o.vosk_model_free(this.handle)}},v=class{constructor(e){this.handle=o.vosk_spk_model_new(e)}free(){o.vosk_spk_model_free(this.handle)}};var h={};p(h,{setLogLevel:()=>x});function x(r){o.vosk_set_log_level(r)}var b={};p(b,{Recognizer:()=>k});var k=class{constructor(e){let{model:t,sampleRate:i}=e;if(e.speakerModel&&e.grammar)throw new Error("grammar and speakerModel cannot be used together for now.");this.handle=e.speakerModel?o.vosk_recognizer_new_spk(t.handle,i,e.speakerModel.handle):e.grammar?o.vosk_recognizer_new_grm(t.handle,i,JSON.stringify(e.grammar)):o.vosk_recognizer_new(t.handle,i)}free(){o.vosk_recognizer_free(this.handle)}setMaxAlternatives(e){return o.vosk_recognizer_set_max_alternatives(this.handle,e),this}setWords(e){return o.vosk_recognizer_set_words(this.handle,e),this}setPartialWords(e){return o.vosk_recognizer_set_partial_words(this.handle,e),this}setSpkModel(e){return o.vosk_recognizer_set_spk_model(this.handle,e.handle),this}acceptWaveform(e){return o.vosk_recognizer_accept_waveform(this.handle,e,e.length)}acceptWaveformAsync(e){return new Promise((t,i)=>{o.vosk_recognizer_accept_waveform.async(this.handle,e,e.length,function(n,w){n?i(n):t(w)})})}resultString(){return o.vosk_recognizer_result(this.handle)}result(){return JSON.parse(o.vosk_recognizer_result(this.handle)||"null")}partialResult(){return JSON.parse(o.vosk_recognizer_partial_result(this.handle)||"null")}finalResult(){return JSON.parse(o.vosk_recognizer_final_result(this.handle)||"null")}reset(){return o.vosk_recognizer_reset(this.handle),this}};var G={...f,...h,...b};0&&(module.exports={Model,Recognizer,SpeakerModel,libvosk,setLogLevel});
